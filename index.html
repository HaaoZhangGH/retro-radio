<!DOCTYPE html>
<html lang="zh-CN">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>Rams-Style Radio (Scattered Dots)</title>
 <script src="https://cdn.tailwindcss.com"></script>
 <style>
     @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;600&family=VT323&display=swap');

     body {
         background-color: #e5e5e5;
         font-family: 'IBM Plex Sans', sans-serif;
         overflow: hidden;
         display: flex;
         flex-direction: column;
         align-items: center;
         justify-content: center;
         min-height: 100vh;
     }

     /* 屏幕发光 */
     .screen-glow {
         filter: drop-shadow(0 0 2px rgba(74, 222, 128, 0.5));
     }

     /* 杂音动画 */
     .static-noise {
         animation: flicker 0.1s infinite;
     }
     @keyframes flicker {
         0% { opacity: 0.1; }
         50% { opacity: 0.3; }
         100% { opacity: 0.1; }
     }

     /* 音柱动画 */
     @keyframes equalize {
         0% { height: 4px; y: 96; }
         50% { height: 25px; y: 75; }
         100% { height: 4px; y: 96; }
     }

     .bar {
         fill: #4ade80;
         transition: fill 0.2s;
     }
     .bar-off {
         fill: #555 !important;
         height: 2px !important;
         y: 98 !important;
         animation: none !important;
     }

     .bar:nth-child(1) { animation: equalize 0.7s ease-in-out infinite alternate; }
     .bar:nth-child(2) { animation: equalize 0.5s ease-in-out infinite alternate; }
     .bar:nth-child(3) { animation: equalize 0.8s ease-in-out infinite alternate; }
     .bar:nth-child(4) { animation: equalize 0.4s ease-in-out infinite alternate; }
     .bar:nth-child(5) { animation: equalize 0.6s ease-in-out infinite alternate; }
     .bar:nth-child(6) { animation: equalize 0.9s ease-in-out infinite alternate; }
     .bar:nth-child(7) { animation: equalize 0.55s ease-in-out infinite alternate; }
     .bar:nth-child(8) { animation: equalize 0.75s ease-in-out infinite alternate; }

     /* 扬声器圆点样式 */
     .speaker-dot {
         fill: #2a2a2a; /* 默认底色：深灰 */
         transition: fill 0.3s ease;
     }

     /* 只有拥有 dynamic-dot 类的点，在 radio-on 状态下才会律动 */
     .radio-on .dynamic-dot {
         /* 使用 CSS 变量实现随机时长，制造零散感 */
         animation: subtle-pulse var(--pulse-duration, 1s) ease-in-out infinite alternate;
         animation-delay: var(--pulse-delay, 0s);
     }

     @keyframes subtle-pulse {
         0% { fill: #2a2a2a; }
         /* 激活色：非常克制的暗绿色，不抢眼 */
         100% { fill: #2d5a35; }
     }

     /* 交互元素样式 */
     .interactive-area {
         cursor: pointer;
     }

     /* 旋钮旋转动画 */
     #tuning-knob-rotate-group {
         transition: transform 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
     }

     .power-btn-hover:hover {
         filter: brightness(1.1);
     }
     .power-btn-active:active {
         filter: brightness(0.9);
     }
     .knob-hover:hover circle:nth-child(1) {
         stroke: #999;
     }
 </style>
</head>
<body class="bg-stone-200">

 <h1 class="text-stone-500 text-2xl mb-8 font-bold tracking-[0.2em] uppercase">Audio Receiver T-3 (Scattered)</h1>

 <!-- SVG 主体 -->
 <svg id="main-radio" width="800" height="460" viewBox="0 0 800 460" xmlns="http://www.w3.org/2000/svg" class="drop-shadow-2xl">
     <defs>
         <linearGradient id="bodyGradient" x1="0%" y1="0%" x2="0%" y2="100%">
             <stop offset="0%" style="stop-color:#f2f2f2;stop-opacity:1" />
             <stop offset="100%" style="stop-color:#dcdcdc;stop-opacity:1" />
         </linearGradient>

         <linearGradient id="knobGradient" x1="0%" y1="0%" x2="100%" y2="100%">
             <stop offset="0%" style="stop-color:#555;stop-opacity:1" />
             <stop offset="50%" style="stop-color:#333;stop-opacity:1" />
             <stop offset="100%" style="stop-color:#111;stop-opacity:1" />
         </linearGradient>

         <filter id="screenShadow">
             <feOffset dx="0" dy="2" />
             <feGaussianBlur stdDeviation="2" result="blur" />
             <feComposite in="SourceGraphic" in2="blur" operator="out" result="inv" />
             <feFlood flood-color="black" flood-opacity="0.5" result="color" />
             <feComposite in="color" in2="inv" operator="in" result="shadow" />
             <feComposite in="shadow" in2="SourceGraphic" operator="over" />
         </filter>
     </defs>

     <!-- 1. 机身主体 -->
     <rect x="50" y="30" width="700" height="400" rx="24" ry="24" fill="url(#bodyGradient)" stroke="#bbb" stroke-width="1" />

     <!-- 2. 左侧扬声器区域 -->
     <!-- 背景黑底 -->
     <rect x="90" y="70" width="320" height="320" rx="16" ry="16" fill="#1a1a1a" />

     <!-- 扬声器网格容器 (由 JS 生成内容) -->
     <g id="speaker-grid" transform="translate(90, 70)">
         <!-- Dots will be generated here -->
     </g>

     <!-- 3. 右侧控制区 -->

     <!-- 3.1 屏幕 -->
     <g transform="translate(450, 70)">
         <!-- 外框 -->
         <rect x="0" y="0" width="260" height="110" rx="6" fill="#111" stroke="#333" stroke-width="2" />
         <!-- 内屏 -->
         <rect x="4" y="4" width="252" height="102" rx="4" fill="#000" filter="url(#screenShadow)" />

         <g id="screen-content" class="screen-glow">
             <text id="freq-text" x="210" y="45" text-anchor="end" fill="#4ade80" font-family="'VT323', monospace" font-size="56">
                 88.5
             </text>
             <text x="215" y="45" text-anchor="start" fill="#4ade80" font-family="'VT323', monospace" font-size="24" dy="-20">MHz</text>

             <text id="station-text" x="15" y="40" text-anchor="start" fill="#fbbf24" font-family="'IBM Plex Sans', sans-serif" font-weight="600" font-size="18" letter-spacing="1">
                 JAZZ CAFE
             </text>

             <g transform="translate(15, 0)" id="equalizer-bars">
                 <rect class="bar" x="0" y="96" width="18" height="4" rx="2" />
                 <rect class="bar" x="24" y="96" width="18" height="4" rx="2" />
                 <rect class="bar" x="48" y="96" width="18" height="4" rx="2" />
                 <rect class="bar" x="72" y="96" width="18" height="4" rx="2" />
                 <rect class="bar" x="96" y="96" width="18" height="4" rx="2" />
                 <rect class="bar" x="120" y="96" width="18" height="4" rx="2" />
                 <rect class="bar" x="144" y="96" width="18" height="4" rx="2" />
                 <rect class="bar" x="168" y="96" width="18" height="4" rx="2" />
             </g>

             <circle cx="235" cy="90" r="3" fill="#ef4444" opacity="0.8" />
             <text x="225" y="93" text-anchor="end" fill="#ef4444" font-family="sans-serif" font-size="9" opacity="0.8">STEREO</text>
         </g>

         <rect id="static-overlay" x="4" y="4" width="252" height="102" rx="4" fill="white" opacity="0" pointer-events="none" />
     </g>

     <!-- 3.2 音量旋钮 -->
     <g transform="translate(490, 250)">
         <circle cx="0" cy="0" r="25" fill="url(#knobGradient)" stroke="#444" stroke-width="1" />
         <circle cx="0" cy="0" r="20" fill="#222" />
         <rect x="-1.5" y="-20" width="3" height="8" rx="1.5" fill="#fff" />
         <text x="0" y="45" text-anchor="middle" fill="#666" font-size="12" font-weight="600" letter-spacing="1">VOLUME</text>
     </g>

     <!-- 3.3 调频大旋钮 -->
     <g id="tuning-knob-area" class="interactive-area knob-hover" onclick="rotateKnob()" transform="translate(620, 300)">

         <!-- 阴影 -->
         <circle cx="0" cy="0" r="52" fill="rgba(0,0,0,0.15)" />

         <!-- 旋转组 -->
         <g id="tuning-knob-rotate-group">
             <circle cx="0" cy="0" r="50" fill="url(#knobGradient)" stroke="#666" stroke-width="1" />
             <circle cx="0" cy="0" r="44" fill="#1a1a1a" />
             <!-- 抓握纹理 -->
             <circle cx="0" cy="0" r="40" fill="none" stroke="#333" stroke-width="4" stroke-dasharray="2 6" opacity="0.3" />
             <!-- 指示点 -->
             <circle cx="0" cy="-35" r="4" fill="#fff" />
         </g>

         <text x="0" y="80" text-anchor="middle" fill="#666" font-size="12" font-weight="600" letter-spacing="1">TUNING</text>
     </g>

     <!-- 3.4 电源开关 -->
     <g transform="translate(465, 340)" class="interactive-area power-btn-hover power-btn-active" onclick="togglePower()">
         <rect x="0" y="0" width="50" height="30" rx="15" fill="#ccc" />
         <rect x="2" y="2" width="46" height="26" rx="13" fill="#333" stroke="#111" stroke-width="1" />
         <text x="25" y="19" text-anchor="middle" fill="#aaa" font-size="10" font-weight="bold">POWER</text>
         <circle id="power-led" cx="65" cy="15" r="4" fill="#444" />
     </g>

     <!-- 天线 -->
     <line x1="680" y1="30" x2="680" y2="5" stroke="#999" stroke-width="3" stroke-linecap="round" />
     <circle cx="680" cy="5" r="3" fill="#999" />

 </svg>

 <div class="mt-4 text-stone-400 text-sm font-mono text-center">
     [ CLICK POWER TO START ] &nbsp;&nbsp; [ CLICK TUNING KNOB TO SCAN ]
 </div>

 <!-- 音频源 -->
 <audio id="jazz-audio" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" preload="auto" loop></audio>
 <audio id="retrowave-audio" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3" preload="auto" loop></audio>
 <audio id="news-audio" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3" preload="auto" loop></audio>
 <audio id="classical-audio" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-4.mp4" preload="auto" loop></audio>
 <audio id="lofi-audio" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-5.mp3" preload="auto" loop></audio>
 <audio id="static-audio" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-6.mp3" preload="auto" loop></audio>
 <audio id="transition-static" src="https://cdn.jsdelivr.net/gh/subhrajitmandal/WhiteNoiseAudio/white_noise.mp3" preload="auto"></audio>

 <script>
     const stations = [
         { name: "JAZZ CAFE", freq: "88.5", type: "FM", audioId: "jazz-audio" },
         { name: "RETRO WAVE", freq: "94.2", type: "FM", audioId: "retrowave-audio" },
         { name: "NEWS TALK", freq: "102.0", type: "AM", audioId: "news-audio" },
         { name: "CLASSIC", freq: "101.1", type: "FM", audioId: "classical-audio" },
         { name: "LO-FI BEATS", freq: "89.0", type: "FM", audioId: "lofi-audio" },
         { name: "STATIC...", freq: "--.-", type: "NOISE", audioId: "static-audio" }
     ];

     let currentStationIndex = 0;
     let knobAngle = 0;
     let isPowerOn = false;

     const mainRadio = document.getElementById('main-radio');
     const knobRotateGroup = document.getElementById('tuning-knob-rotate-group');
     const freqText = document.getElementById('freq-text');
     const stationText = document.getElementById('station-text');
     const staticOverlay = document.getElementById('static-overlay');
     const equalizerBars = document.getElementById('equalizer-bars');
     const bars = document.querySelectorAll('.bar');
     const powerLED = document.getElementById('power-led');
     const transitionStaticAudio = document.getElementById('transition-static');
     const speakerGrid = document.getElementById('speaker-grid');

     const allAudios = Array.from(document.querySelectorAll('audio')).filter(a => a.id !== 'transition-static');
     allAudios.forEach(a => { a.volume = 0.5; a.pause(); a.currentTime = 0; });
     transitionStaticAudio.volume = 0.3;

     // --- 生成扬声器网格逻辑 ---
     function generateSpeakerGrid() {
         const width = 320;
         const height = 320;
         const spacing = 10; // 间距
         const cols = Math.floor(width / spacing);
         const rows = Math.floor(height / spacing);
         const radius = 2;

         // 考虑到圆角矩形的外框，我们可以简单地生成一个矩形区域的点
         // 因为外框有 border-radius，溢出的点视觉上会被外框遮挡（如果使用clip-path），
         // 但这里我们为了性能，只生成在矩形内的点，边缘的视觉上无所谓。

         // 创建一个 fragment 以优化 DOM 插入性能
         const fragment = document.createDocumentFragment();
         const svgNS = "http://www.w3.org/2000/svg";

         for (let i = 1; i < cols; i++) {
             for (let j = 1; j < rows; j++) {
                 const cx = i * spacing;
                 const cy = j * spacing;

                 // 简单的圆形边界检查 (模拟圆角)，如果点太靠近四个角落则不生成
                 // 这里我们让网格稍微内缩一点即可
                 if (cx < 8 || cx > width - 8 || cy < 8 || cy > height - 8) continue;

                 const dot = document.createElementNS(svgNS, "circle");
                 dot.setAttribute("cx", cx);
                 dot.setAttribute("cy", cy);
                 dot.setAttribute("r", radius);
                 dot.classList.add("speaker-dot");

                 // 随机逻辑：只有 5% 的点是“活跃”的
                 if (Math.random() < 0.05) {
                     dot.classList.add("dynamic-dot");
                     // 随机动画时长 (0.5s - 1.5s)
                     const duration = 0.5 + Math.random();
                     // 随机延迟 (0s - 1s)
                     const delay = Math.random();

                     dot.style.setProperty('--pulse-duration', `${duration}s`);
                     dot.style.setProperty('--pulse-delay', `${delay}s`);
                 }

                 fragment.appendChild(dot);
             }
         }
         speakerGrid.appendChild(fragment);
     }

     // 初始化生成网格
     generateSpeakerGrid();

     function stopAllAudios() {
         allAudios.forEach(a => a.pause());
         transitionStaticAudio.pause();
         transitionStaticAudio.currentTime = 0;
     }

     function updateUI() {
         if (!isPowerOn) {
             freqText.textContent = "";
             stationText.textContent = "";
             equalizerBars.style.opacity = "0";
             powerLED.setAttribute('fill', '#444');
             bars.forEach(b => b.classList.add('bar-off'));
             stopAllAudios();
             mainRadio.classList.remove('radio-on');
             return;
         }

         mainRadio.classList.add('radio-on');

         powerLED.setAttribute('fill', '#22c55e');
         equalizerBars.style.opacity = "1";

         const station = stations[currentStationIndex];
         freqText.textContent = station.freq;
         stationText.textContent = station.name;

         stopAllAudios();
         const audio = document.getElementById(station.audioId);
         if(audio) audio.play().catch(e => console.log("Autoplay prevented"));

         if (station.type === 'NOISE') {
             bars.forEach(b => {
                 b.classList.remove('bar-off');
                 b.style.animationDuration = '0.1s';
             });
         } else {
             bars.forEach((b, i) => {
                 b.classList.remove('bar-off');
                 const durations = [0.7, 0.5, 0.8, 0.4, 0.6, 0.9, 0.55, 0.75];
                 b.style.animationDuration = durations[i] + 's';
             });
         }
     }

     function togglePower() {
         isPowerOn = !isPowerOn;
         updateUI();
     }

     function rotateKnob() {
         if (!isPowerOn) return;

         knobAngle += 60;
         knobRotateGroup.style.transform = `rotate(${knobAngle}deg)`;

         staticOverlay.classList.add('static-noise');
         staticOverlay.style.opacity = "0.2";
         transitionStaticAudio.play();

         stopAllAudios();
         bars.forEach(b => b.classList.add('bar-off'));

         setTimeout(() => {
             currentStationIndex = (currentStationIndex + 1) % stations.length;
             updateUI();
             staticOverlay.classList.remove('static-noise');
             staticOverlay.style.opacity = "0";
         }, 400);
     }

     updateUI();

 </script>
</body>
</html>
